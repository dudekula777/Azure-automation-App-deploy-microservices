name: Full CI/CD Pipeline (Sequential)

on:
  workflow_dispatch:  # Manual trigger for full pipeline

jobs:
  terraform:
    name: "1 - Infrastructure (Terraform)"
    uses: ./.github/workflows/terraform.yml
    secrets: inherit

  docker:
    name: "2 - Build Images (Docker)"
    needs: terraform
    uses: ./.github/workflows/docker.yml
    secrets: inherit

  deploy:
    name: "3 - Deploy to AKS"
    needs: docker
    uses: ./.github/workflows/deploy.yml
    secrets: inherit